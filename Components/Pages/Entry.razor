@page "/languages"
@using LanguageLearning.Components.Layout
@using LanguageLearning.Domain
@rendermode InteractiveServer
@layout UserLayout
@inject HttpClient httpClient

<link href="Manage.css" rel="stylesheet" />

<div class="d-flex align-items-center justify-content-center flex-column">
    <h1 style="color:#845007">Build Language Skills </h1>
    <h2 style="color:#845007">Master Language You Want To Learn With Us</h2>
</div>
<div class="w-100 h-25 d-flex align-items-center justify-content-center">
    <input style="outline: none; box-shadow: none;"
        class="my-3 rounded-2 w-25 h-100 fs-4 entry-search" 
    type="search" @bind="searchText" @bind:event="oninput" placeholder="Search" autofocus />
</div>
<div class="container"> 
    <div class="row g-4">
        @foreach (var language in FilteredLanguages)
        {
            <div class="col-12 col-md-6 col-lg-4" style="position: relative;">
                <a href="@($"/language?id={language.Id}")" class="card-link w-25 rounded-3"
                   style="@(developedLanguageIds.Contains(language.Id) ? "" : "pointer-events: none; opacity: 0.5; cursor: not-allowed;")">
                <Card Name=@language.Name Description=@language.Description />
                    @if (!developedLanguageIds.Contains(language.Id))
                    {
                        <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center;
                                font-size: 1.5rem; font-weight: bold; color: #fff;
                                background: rgba(0,0,0,0.6); pointer-events: none;">
                            Coming Soon...
                        </div>
                    }
                </a>
            </div>
        }
    </div>
</div>


@code {
    List<Language> Languages = new();
    string searchText = "";

    List<int> developedLanguageIds = new() {3,4, 5, 6, 10,11 };

    // Computed property that filters based on searchText
    List<Language> FilteredLanguages => string.IsNullOrWhiteSpace(searchText)
        ? Languages
        : Languages.Where(l => l.Name.Contains(searchText, StringComparison.OrdinalIgnoreCase)).ToList();

    protected override async Task OnInitializedAsync()
    {
        Languages = await httpClient.GetFromJsonAsync<List<Language>>("api/languages") ?? new List<Language>();
    }
}
